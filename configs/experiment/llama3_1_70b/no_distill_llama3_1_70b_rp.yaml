dataset:
  name: redpajama_sample
  dataset_config:
    train_data: 
    - redpajama/train.json[50000]
    eval_data:
    - redpajama/train.json
    max_eval_num: 1000
    max_length: 32768
    min_length: 1024
    chat_template: llama-3
    chunk_size: 1024  # sequence length for distilling
    seed: 42
    cache_dir: "data/rp"
  pretrained_model_config:
    pretrained_model_name_or_path: "meta-llama/Meta-Llama-3.1-70B"
    cache_dir: "/data_persistent2/sim_data/llama-3_1-70b/" 
  preprocess_config: null

dataloader:
  batch_size: 1
  num_workers: 2
  drop_last: false
  pin_memory: true

optimizer:
  optim: adamw_torch_fused
  lr: 0.01
  weight_decay: 0.0

lr_scheduler:
  lr_scheduler_type: none

trainer:  # HuggingFace Trainer-like arguments  
  name: null

  bf16: true
  train_split: train
  val_split: validation
  num_train_epochs: 2
  gradient_accumulation_steps: 8
  seed: 42
  batch_size: 1
  load_best_model_at_end: true
  greater_is_better: false
  metric_for_best_model: distill/eval/loss
  logging_steps: 100
  evaluation_strategy: steps
  max_steps: -1
  eval_steps: 160 # round number for batch size grad accums
  max_eval_batches: null